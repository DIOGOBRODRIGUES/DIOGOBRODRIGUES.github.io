<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8">
  <title>Aula 3: Arquitetura de Dispositivos Móveis e Notificações</title>

  <meta name="description" content="Codificação nativa, arquitetura mobile e sistema de notificações push">
  <meta name="author" content="Prof. Dr. Diogo Francisco Borba Rodrigues">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="../../../../../reveal.js-master/dist/reset.css">
  <link rel="stylesheet" href="../../../../../reveal.js-master/dist/reveal.css">
  <link rel="stylesheet" href="../../../../../reveal.js-master/dist/theme/dracula.css" id="theme">

  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="../../../../../reveal.js-master/plugin/highlight/monokai.css">

</head>

<body>
 
  <div class="reveal">
    <div class="slides">
      <!-- Slide 1 - Título da Aula -->
      <section>
        <p>🏛️ Centro Universitário Maurício de Nassau</p>
        <h3>Aula 3: Arquitetura de Dispositivos Móveis</h3>
        <p><strong>Codificação de Alta Performance Mobile</strong></p>
        <p>Prof. Dr. Diogo Francisco Borba Rodrigues</p>
        <a href="https://www.linkedin.com/in/diogo-francisco-borba-rodrigues-3a1b5179/" target="_blank">
          <i class="fab fa-linkedin"></i>
        </a>
        <a href="https://github.com/DIOGOBRODRIGUES" target="_blank">
          <i class="fab fa-github"></i>
        </a>
        <a href="https://www.instagram.com/diogofbranco" target="_blank">
          <i class="fab fa-instagram"></i>
        </a>
      </section>

      <!-- Slide 2 - Objetivos da Aula -->
      <section>
        <h2>🎯 Objetivos da Aula</h2>
        <ul>
          <li>🏗️ Compreender arquiteturas de dispositivos móveis</li>
          <li>⚛️ Diferenças entre codificação nativa, híbrida e cross-platform</li>
          <li>🔔 Implementar sistema de notificações push</li>
          <li>📡 Configurar listeners e providers personalizados</li>
          <li>🎯 Otimizar performance através da arquitetura</li>
          <li>📱 Entender limitações e vantagens de cada abordagem</li>
        </ul>
      </section>

      <!-- Slide 3 - Arquitetura Mobile: Visão Geral -->
      <section>
        <h2>🏗️ Arquitetura de Dispositivos Móveis</h2>
        <section>
          <h3>📱 Camadas da Arquitetura Mobile</h3>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
            <div>
              <h4>🍎 iOS</h4>
              <ul style="font-size: 0.8em;">
                <li>🎨 <strong>UIKit/SwiftUI:</strong> Interface</li>
                <li>🧠 <strong>Foundation:</strong> Core APIs</li>
                <li>⚡ <strong>Core Services:</strong> Sistema</li>
                <li>🔧 <strong>Darwin/XNU:</strong> Kernel</li>
              </ul>
            </div>
            <div>
              <h4>🤖 Android</h4>
              <ul style="font-size: 0.8em;">
                <li>🎨 <strong>View System:</strong> Interface</li>
                <li>🧠 <strong>Android Framework:</strong> APIs</li>
                <li>⚡ <strong>ART/Dalvik:</strong> Runtime</li>
                <li>🔧 <strong>Linux Kernel:</strong> Sistema</li>
              </ul>
            </div>
          </div>
          <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 400'%3E%3Crect width='800' height='400' fill='%23f0f0f0'/%3E%3Ctext x='400' y='200' text-anchor='middle' font-size='24' fill='%23333'%3EArquitetura Mobile em Camadas%3C/text%3E%3C/svg%3E" alt="Mobile Architecture" style="max-width: 60%; margin-top: 20px;">
        </section>
        <section>
          <h3>🔄 Tipos de Desenvolvimento Mobile</h3>
          <table style="font-size: 0.7em; width: 100%;">
            <thead>
              <tr>
                <th>Abordagem</th>
                <th>Performance</th>
                <th>Desenvolvimento</th>
                <th>Exemplo</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>🎯 <strong>Nativo</strong></td>
                <td>⭐⭐⭐⭐⭐</td>
                <td>❌ Mais complexo</td>
                <td>Swift/Kotlin</td>
              </tr>
              <tr>
                <td>⚛️ <strong>Cross-Platform</strong></td>
                <td>⭐⭐⭐⭐</td>
                <td>✅ Médio</td>
                <td>React Native/Flutter</td>
              </tr>
              <tr>
                <td>🌐 <strong>Híbrido</strong></td>
                <td>⭐⭐⭐</td>
                <td>✅ Fácil</td>
                <td>Cordova/Ionic</td>
              </tr>
              <tr>
                <td>🌍 <strong>Web/PWA</strong></td>
                <td>⭐⭐</td>
                <td>✅✅ Muito fácil</td>
                <td>PWA</td>
              </tr>
            </tbody>
          </table>
        </section>
      </section>

      <!-- Slide 4 - React Native Architecture -->
      <section>
        <h2>⚛️ Arquitetura do React Native</h2>
        <section>
          <h3>🏗️ Como Funciona o React Native</h3>
          <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23282c34'/%3E%3Ctext x='400' y='100' text-anchor='middle' font-size='20' fill='%2361dafb'%3EReact Native Architecture%3C/text%3E%3Crect x='50' y='150' width='200' height='80' fill='%2361dafb' rx='10'/%3E%3Ctext x='150' y='195' text-anchor='middle' font-size='14' fill='%23282c34'%3EJavaScript Thread%3C/text%3E%3Crect x='300' y='150' width='200' height='80' fill='%23ff6b6b' rx='10'/%3E%3Ctext x='400' y='195' text-anchor='middle' font-size='14' fill='white'%3EBridge%3C/text%3E%3Crect x='550' y='150' width='200' height='80' fill='%234ecdc4' rx='10'/%3E%3Ctext x='650' y='195' text-anchor='middle' font-size='14' fill='%23282c34'%3ENative Thread%3C/text%3E%3Cpath d='M250 190 L300 190' stroke='%23333' stroke-width='3' marker-end='url(%23arrowhead)'/%3E%3Cpath d='M500 190 L550 190' stroke='%23333' stroke-width='3' marker-end='url(%23arrowhead)'/%3E%3Cdefs%3E%3Cmarker id='arrowhead' markerWidth='10' markerHeight='7' refX='9' refY='3.5' orient='auto'%3E%3Cpolygon points='0 0, 10 3.5, 0 7' fill='%23333' /%3E%3C/marker%3E%3C/defs%3E%3C/svg%3E" alt="RN Architecture" style="max-width: 80%;">
          <ul>
            <li>🧠 <strong>JavaScript Thread:</strong> Lógica do app React</li>
            <li>🌉 <strong>Bridge:</strong> Comunicação assíncrona</li>
            <li>📱 <strong>Native Thread:</strong> UI e módulos nativos</li>
          </ul>
        </section>
        <section>
          <h3>⚡ New Architecture (Fabric + TurboModules)</h3>
          <pre><code data-trim class="javascript">
// Nova arquitetura remove a Bridge
// Comunicação síncrona JavaScript ↔ Native

// Fabric: Novo renderizador
// - Renderização síncrona
// - Melhor performance
// - Suporte a concurrent features

// TurboModules: Novos módulos nativos
// - Lazy loading
// - Type safety
// - Melhor performance

// Habilitando no app
// react-native.config.js
module.exports = {
  project: {
    ios: {},
    android: {},
  },
  assets: ['./src/assets/fonts/'],
  // Nova arquitetura
  newArchitecture: {
    enabled: true,
  },
};
          </code></pre>
        </section>
      </section>

      <!-- Slide 5 - Sistema de Notificações -->
      <section>
        <h2>🔔 Sistema de Notificações Push</h2>
        <section>
          <h3>📡 Arquitetura de Push Notifications</h3>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
            <div>
              <h4>🍎 iOS - APNs</h4>
              <ul style="font-size: 0.8em;">
                <li>🔐 <strong>Certificates:</strong> .p12 ou .p8</li>
                <li>📱 <strong>Device Token:</strong> Identificador único</li>
                <li>📡 <strong>APNs Server:</strong> Apple Push Service</li>
                <li>🎯 <strong>Payload:</strong> Até 4KB</li>
              </ul>
            </div>
            <div>
              <h4>🤖 Android - FCM</h4>
              <ul style="font-size: 0.8em;">
                <li>🔑 <strong>Server Key:</strong> Firebase Console</li>
                <li>📱 <strong>Registration Token:</strong> Firebase SDK</li>
                <li>📡 <strong>FCM Server:</strong> Firebase Cloud Messaging</li>
                <li>🎯 <strong>Payload:</strong> Até 4KB</li>
              </ul>
            </div>
          </div>
        </section>
        <section>
          <h3>🚀 Implementando Push com Expo</h3>
          <pre><code data-trim class="javascript">
// Instalar dependências
// expo install expo-notifications expo-device expo-constants

import * as Notifications from 'expo-notifications';
import * as Device from 'expo-device';
import Constants from 'expo-constants';

// Configurar handler de notificações
Notifications.setNotificationHandler({
  handleNotification: async () => ({
    shouldShowAlert: true,
    shouldPlaySound: true,
    shouldSetBadge: false,
  }),
});

async function registerForPushNotificationsAsync() {
  let token;
  
  if (Device.isDevice) {
    const { status: existingStatus } = await Notifications.getPermissionsAsync();
    let finalStatus = existingStatus;
    
    if (existingStatus !== 'granted') {
      const { status } = await Notifications.requestPermissionsAsync();
      finalStatus = status;
    }
    
    if (finalStatus !== 'granted') {
      alert('Falha ao obter token para push notification!');
      return;
    }
    
    token = (await Notifications.getExpoPushTokenAsync()).data;
    console.log('Push Token:', token);
  } else {
    alert('Deve usar um dispositivo físico para push notifications');
  }

  return token;
}
          </code></pre>
        </section>
        <section>
          <h3>📱 Usando Notificações no App</h3>
          <pre><code data-trim class="javascript">
import { useState, useEffect, useRef } from 'react';

export default function App() {
  const [expoPushToken, setExpoPushToken] = useState('');
  const [notification, setNotification] = useState(false);
  const notificationListener = useRef();
  const responseListener = useRef();

  useEffect(() => {
    registerForPushNotificationsAsync().then(token => setExpoPushToken(token));

    // Listener para notificações recebidas
    notificationListener.current = Notifications.addNotificationReceivedListener(notification => {
      setNotification(notification);
    });

    // Listener para interação com notificação
    responseListener.current = Notifications.addNotificationResponseReceivedListener(response => {
      console.log('Notificação clicada:', response);
      // Navegar para tela específica
      navigation.navigate('Details', { id: response.notification.request.content.data.id });
    });

    return () => {
      Notifications.removeNotificationSubscription(notificationListener.current);
      Notifications.removeNotificationSubscription(responseListener.current);
    };
  }, []);

  const sendPushNotification = async () => {
    await Notifications.scheduleNotificationAsync({
      content: {
        title: "📬 Você tem uma nova mensagem!",
        body: 'Clique para ver os detalhes',
        data: { data: 'dados extras aqui' },
      },
      trigger: { seconds: 2 },
    });
  };

  return (
    // UI components
  );
}
          </code></pre>
        </section>
      </section>

      <!-- Slide 6 - Listeners e Providers -->
      <section>
        <h2>👂 Listeners e Content Providers</h2>
        <section>
          <h3>🔄 Event Listeners Nativos</h3>
          <pre><code data-trim class="javascript">
import { useEffect } from 'react';
import { AppState, NetInfo, DeviceEventEmitter } from 'react-native';

function useAppStateListener() {
  useEffect(() => {
    const handleAppStateChange = (nextAppState) => {
      if (nextAppState === 'active') {
        console.log('App em primeiro plano');
        // Atualizar dados, verificar notificações
      } else if (nextAppState === 'background') {
        console.log('App em segundo plano');
        // Salvar estado, pausar operações
      }
    };

    const subscription = AppState.addEventListener(
      'change',
      handleAppStateChange
    );

    return () => {
      subscription?.remove();
    };
  }, []);
}

function useNetworkListener() {
  const [isConnected, setIsConnected] = useState(true);

  useEffect(() => {
    const unsubscribe = NetInfo.addEventListener(state => {
      setIsConnected(state.isConnected);
      
      if (!state.isConnected) {
        // Modo offline - usar cache
        console.log('Conexão perdida - modo offline');
      } else {
        // Sincronizar dados pendentes
        console.log('Conexão restabelecida - sincronizando');
      }
    });

    return unsubscribe;
  }, []);

  return isConnected;
}
          </code></pre>
        </section>
        <section>
          <h3>📡 Custom Service Providers</h3>
          <pre><code data-trim class="javascript">
// Services/NotificationService.js
class NotificationService {
  constructor() {
    this.listeners = [];
    this.setupListeners();
  }

  setupListeners() {
    // Listener para notificações em foreground
    this.foregroundListener = Notifications.addNotificationReceivedListener(
      this.handleForegroundNotification.bind(this)
    );

    // Listener para cliques em notificações
    this.clickListener = Notifications.addNotificationResponseReceivedListener(
      this.handleNotificationClick.bind(this)
    );
  }

  handleForegroundNotification(notification) {
    // Processar notificação quando app está ativo
    const { title, body, data } = notification.request.content;
    
    // Mostrar banner personalizado ou modal
    this.showCustomNotification({ title, body, data });
    
    // Notificar listeners
    this.notifyListeners('foregroundNotification', notification);
  }

  handleNotificationClick(response) {
    const { data } = response.notification.request.content;
    
    // Navegar para tela específica baseado nos dados
    if (data.screen) {
      NavigationService.navigate(data.screen, data.params);
    }
    
    this.notifyListeners('notificationClick', response);
  }

  addListener(event, callback) {
    this.listeners.push({ event, callback });
  }

  removeListener(callback) {
    this.listeners = this.listeners.filter(l => l.callback !== callback);
  }

  notifyListeners(event, data) {
    this.listeners
      .filter(l => l.event === event)
      .forEach(l => l.callback(data));
  }

  cleanup() {
    this.foregroundListener?.remove();
    this.clickListener?.remove();
    this.listeners = [];
  }
}

export default new NotificationService();
          </code></pre>
        </section>
      </section>

      <!-- Slide 7 - Performance e Otimização -->
      <section>
        <h2>⚡ Otimização de Performance</h2>
        <section>
          <h3>🎯 Estratégias de Otimização</h3>
          <ul>
            <li>🧠 <strong>Memory Management:</strong> Evitar vazamentos</li>
            <li>⚡ <strong>Lazy Loading:</strong> Carregar sob demanda</li>
            <li>📦 <strong>Bundle Splitting:</strong> Dividir código</li>
            <li>🗜️ <strong>Image Optimization:</strong> Formatos eficientes</li>
            <li>🔄 <strong>State Management:</strong> Redux/Context otimizado</li>
          </ul>
        </section>
        <section>
          <h3>📊 Monitoramento de Performance</h3>
          <pre><code data-trim class="javascript">
// Performance API para medir operações
import { performance } from 'perf_hooks';

class PerformanceMonitor {
  static measureAsync(name, asyncOperation) {
    return async (...args) => {
      const start = performance.now();
      
      try {
        const result = await asyncOperation(...args);
        const duration = performance.now() - start;
        
        console.log(`${name} completed in ${duration.toFixed(2)}ms`);
        
        // Enviar métricas para analytics
        this.sendMetrics(name, duration, 'success');
        
        return result;
      } catch (error) {
        const duration = performance.now() - start;
        console.error(`${name} failed in ${duration.toFixed(2)}ms:`, error);
        
        this.sendMetrics(name, duration, 'error');
        throw error;
      }
    };
  }

  static sendMetrics(operation, duration, status) {
    // Enviar para serviço de analytics
    Analytics.track('performance_metric', {
      operation,
      duration,
      status,
      timestamp: Date.now()
    });
  }
}

// Uso
const fetchUserData = PerformanceMonitor.measureAsync(
  'fetchUserData',
  async (userId) => {
    const response = await api.get(`/users/${userId}`);
    return response.data;
  }
);
          </code></pre>
        </section>
      </section>

      <!-- Slide 8 - Background Tasks -->
      <section>
        <h2>⏱️ Background Tasks e Services</h2>
        <section>
          <h3>🔄 Background Processing</h3>
          <pre><code data-trim class="javascript">
// Background Tasks com Expo
import * as TaskManager from 'expo-task-manager';
import * as BackgroundFetch from 'expo-background-fetch';

const BACKGROUND_SYNC_TASK = 'background-sync';

// Definir task
TaskManager.defineTask(BACKGROUND_SYNC_TASK, async () => {
  try {
    // Sincronizar dados críticos
    await syncCriticalData();
    
    // Verificar notificações pendentes
    await checkPendingNotifications();
    
    console.log('Background sync completed');
    return BackgroundFetch.BackgroundFetchResult.NewData;
  } catch (error) {
    console.error('Background sync failed:', error);
    return BackgroundFetch.BackgroundFetchResult.Failed;
  }
});

// Registrar background task
async function registerBackgroundTask() {
  try {
    await BackgroundFetch.registerTaskAsync(BACKGROUND_SYNC_TASK, {
      minimumInterval: 15 * 60, // 15 minutos
      stopOnTerminate: false,
      startOnBoot: true,
    });
    console.log('Background task registered');
  } catch (err) {
    console.log('Background task registration failed:', err);
  }
}

async function syncCriticalData() {
  // Implementar lógica de sincronização
  const pendingData = await AsyncStorage.getItem('pendingSync');
  if (pendingData) {
    await api.post('/sync', JSON.parse(pendingData));
    await AsyncStorage.removeItem('pendingSync');
  }
}
          </code></pre>
        </section>
      </section>

      <!-- Slide 9 - Exercício Prático -->
      <section>
        <h2>💻 Exercício Prático</h2>
        <section>
          <h3>🎯 Desafio: Sistema de Notificações Completo</h3>
          <p>Implementar sistema robusto de notificações:</p>
          <ul>
            <li>🔔 <strong>Push Notifications:</strong> Configurar APNs/FCM</li>
            <li>📱 <strong>Local Notifications:</strong> Lembretes e tarefas</li>
            <li>🎯 <strong>Custom Handlers:</strong> Diferentes tipos de notificação</li>
            <li>📊 <strong>Analytics:</strong> Tracking de engajamento</li>
            <li>⚡ <strong>Background Sync:</strong> Sincronização de dados</li>
          </ul>
        </section>
        <section>
          <h3>🏗️ Estrutura do Projeto</h3>
          <pre><code data-trim class="javascript">
src/
├── services/
│   ├── NotificationService.js
│   ├── BackgroundSyncService.js
│   └── AnalyticsService.js
├── hooks/
│   ├── useNotifications.js
│   ├── useBackgroundSync.js
│   └── useAppState.js
├── components/
│   ├── NotificationBanner.js
│   └── NotificationSettings.js
└── screens/
    ├── HomeScreen.js
    ├── NotificationsScreen.js
    └── SettingsScreen.js
          </code></pre>
        </section>
        <section>
          <h3>✅ Requisitos do Exercício</h3>
          <ul>
            <li>🎨 <strong>UI Personalizada:</strong> Banner de notificação custom</li>
            <li>⚙️ <strong>Configurações:</strong> Usuário pode ativar/desativar tipos</li>
            <li>📊 <strong>Dashboard:</strong> Histórico de notificações</li>
            <li>🔔 <strong>Diferentes Tipos:</strong> Info, warning, error, success</li>
            <li>⏰ <strong>Agendamento:</strong> Notificações programadas</li>
            <li>📱 <strong>Deep Linking:</strong> Navegação por notificação</li>
          </ul>
        </section>
      </section>

      <!-- Slide 10 - Resumo e Próximos Passos -->
      <section>
        <h2>📝 Resumo da Aula</h2>
        <section>
          <h3>✅ O que Vimos Hoje</h3>
          <ul>
            <li>🏗️ Arquitetura de dispositivos móveis (iOS/Android)</li>
            <li>⚛️ Funcionamento interno do React Native</li>
            <li>🔔 Sistema completo de notificações push</li>
            <li>👂 Listeners e service providers personalizados</li>
            <li>⚡ Estratégias de otimização de performance</li>
            <li>⏱️ Background tasks e sincronização</li>
          </ul>
        </section>
        <section>
          <h3>🚀 Próxima Aula</h3>
          <h4>Aula 4: Comunicação via Rede</h4>
          <ul>
            <li>🌐 Carregamento de dados em segundo plano</li>
            <li>🔒 Comunicação HTTP/HTTPS segura</li>
            <li>📡 Consumo de APIs REST e GraphQL</li>
            <li>🔄 Cache e sincronização offline</li>
          </ul>
        </section>
        <section>
          <h3>📚 Tarefa de Casa</h3>
          <ul>
            <li>🔔 Implemente sistema de notificações completo</li>
            <li>⚡ Otimize performance do seu Todo App</li>
            <li>📊 Adicione monitoramento de performance</li>
            <li>🎯 Configure background sync</li>
            <li>📱 Teste em dispositivo físico</li>
          </ul>
        </section>
      </section>

   </div>
  </div>


  <script src="../../../../../reveal.js-master/dist/reveal.js"></script>
  <script src="../../../../../reveal.js-master/plugin/zoom/zoom.js"></script>
  <script src="../../../../../reveal.js-master/plugin/notes/notes.js"></script>
  <script src="../../../../../reveal.js-master/plugin/search/search.js"></script>
  <script src="../../../../../reveal.js-master/plugin/markdown/markdown.js"></script>
  <script src="../../../../../reveal.js-master/plugin/highlight/highlight.js"></script>
  <script>
    Reveal.initialize({
      controls: true,
      progress: true,
      center: true,
      hash: true,
      slideNumber: true,
      plugins: [RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight]
    });
  </script>
</body>

</html>
